---
layout: post
title: 동기화와 교착 상태
subtitle: 개발자로서 알아야 할 객체지향 프로그래밍
tags: [CS]
comments: true
author: CoderNyang
---

***

## **3.3 동기화와 교착 상태**

### 3.3.1 공유 자원과 임계 영역(Critical Section)

1. **공유 자원**

   * 여러 프로세스 혹은 스레드가 **동시에 접근**하고 사용하는 자원(변수, 파일, 메모리 공간 등)을 뜻해요.
   * 예: 은행 계좌 잔고(한 스레드가 입금 중인데, 다른 스레드가 동시에 출금하면 문제가 생길 수 있음)

2. **임계 영역(Critical Section)**

   * “공유 자원을 접근·수정하는 부분”을 임계 영역이라고 불러요.
   * **둘 이상의 스레드**가 동시에 임계 영역에 진입하여 자원을 건드리면 **충돌**(Race Condition)이 발생할 수 있음.

3. **동기화(Synchronization)의 필요성**

   * 임계 영역에는 **동시에 하나의 스레드만** 들어가도록 제어해야, 데이터 무결성을 지킬 수 있음.
   * 이를 위해 **뮤텍스(Mutex), 세마포어(Semaphore), 모니터(Monitor)** 등 동기화 도구를 사용.

***

### 3.3.2 동기화 기법

1. **뮤텍스(Mutex)**

   * \*\*상호 배제(Mutual Exclusion)\*\*를 위한 잠금(Lock) 개념을 사용.
   * 스레드가 임계 영역에 진입하기 전에 “뮤텍스 Lock”을 획득하고, 빠져나올 때 “뮤텍스 Unlock”을 함.
   * 다른 스레드는 Lock이 해제될 때까지 대기.

2. **세마포어(Semaphore)**

   * 뮤텍스와 유사하지만, **‘카운팅’** 개념이 추가된 동기화 도구.
   * 예: 세마포어 값이 3이라면, **동시에 최대 3개의 스레드**까지 자원을 사용 가능.
   * 뮤텍스는 “0 또는 1” 형태(이진 세마포어)에 가깝고, 세마포어는 좀 더 일반화된 경우.

3. **모니터(Monitor)**

   * 객체 지향 프로그래밍에서 “임계 영역을 안전하게 보장”하는 고수준 구조.
   * 자바의 `synchronized` 키워드나 파이썬의 스레드 락 등이 모니터 개념을 활용해 구현됨.

4. **락(Lock)과 컨디션 변수(Condition Variable)**

   * 락: 뮤텍스처럼 임계 영역을 독점하기 위한 잠금
   * 컨디션 변수: “공유 자원 상태가 특정 조건이 될 때까지 대기했다가, 조건 충족 시 깨어나는” 메커니즘

***

### 3.3.3 교착 상태(Deadlock)

1. **교착 상태란?**

   * 여러 프로세스 혹은 스레드가 서로 **자원(락, 세마포어 등)을 점유**한 채, 상대가 가진 자원을 기다리면서 **영원히 대기**하는 상황.
   * 예: 스레드 A가 뮤텍스1을 들고 있고, 스레드 B가 뮤텍스2를 들고 있는데, A는 뮤텍스2가 필요하고 B는 뮤텍스1이 필요한 상황 → 서로 기다리며 멈춤

2. **교착 상태 발생 조건 (Deadlock Condition)**\
   보통 아래 4가지 조건이 **모두** 만족되면 교착 상태가 발생할 수 있다고 해요.

   * **상호 배제(Mutual Exclusion)**: 자원은 한 번에 한 스레드만 사용 가능
   * **점유 대기(Hold and Wait)**: 자원을 이미 점유한 스레드가 다른 자원을 기다리는 상태
   * **비선점(No Preemption)**: 자원을 강제로 빼앗을 수 없음
   * **순환 대기(Circular Wait)**: 스레드들이 원형으로 서로가 가진 자원을 요구하며 대기

3. **교착 상태 해결 전략**

   1. **예방(Prevention)**

      * 교착 상태 4가지 조건 중 하나를 **미리** 깨뜨리게 하여, 교착 상태가 아예 발생하지 않도록 설계.
      * 예: 자원을 한 번에 모두 할당받고 시작(점유 대기 조건을 깨뜨림)

   2. **회피(Avoidance)**

      * 시스템이 자원 상태를 **실시간으로 감시**하며, 교착 상태가 일어날 것 같으면 허용하지 않음
      * 대표 알고리즘: **은행원 알고리즘(Banker's Algorithm)**

   3. **발견(Detection) 및 복구(Recovery)**
      * 교착 상태가 발생했는지 검사(그래프 분석 등)한 후, 발생 시 일부 프로세스를 강제 종료하거나 자원을 선점해 해결

***

### 3.3.4 동기화 & 교착 상태 요약

* 멀티스레드, 멀티프로세스 환경에서는 공유 자원에 대한 **동기화**가 매우 중요합니다.
* 동기화를 잘못 처리하면 **레이스 컨디션**, **교착 상태** 등 심각한 문제가 발생.
* **뮤텍스**, **세마포어** 같은 기법으로 임계 영역을 보호하고, **교착 상태**를 예방/회피/검출/복구하는 전략이 필요합니다.

***

여기까지 **동기화와 교착 상태**에 대해 알아봤어요.\
궁금한 점이 있거나, 준비되셨다면 “다음”이라고 입력해 주시면 **3.4 CPU 스케줄링 알고리즘**으로 넘어가겠습니다!
